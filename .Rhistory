labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=porcs)) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=50,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=45,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=56,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=57,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(YNLecE_all, aes(x=factor(YNLecE_YN),y=porcsYNLecE,
fill=factor(YNLecE_Edades,levels=rev(c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años"))),label=ifelse(porcsYNLecE>=33,paste0(round(porcsYNLecE,1),"%"),"")))+
geom_bar(stat='identity') +
theme_bw()+
scale_fill_brewer(palette ="Set3",direction=-1) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
#geom_text(data=YNLecE_all,aes(x=YNLecE_YN,y=pos,label=ifelse(porcsYNLecE>=33,paste0(round(porcsYNLecE,1),"%"),"")), size=3.5) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje relativo por rango de edad",
fill="Rango de Edad")+
facet_wrap(~YNLecE_DI)
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
YNLecZ_all <- data.frame(Fill=YNLecZ_Zona,DI=YNLecZ_DI,YN=YNLecZ_YN,nums=numsYNLecZ,porcs=porcsYNLecZ)
View(YNLecE_all)
View(YNLecZ_all)
YNLecE_all <- data.frame(Fill=YNLecE_Edades,DI=YNLecE_DI,YN=YNLecE_YN,nums=numsYNLecE,porcs=porcsYNLecE)
library(plyr)
YNLecE_all <- ddply(YNLecE_all, .(YNLecE_YN),
transform, pos = cumsum(porcsYNLecE) - (0.5 * porcsYNLecE))
detach("package:plyr",unload = T)
YNLecE_all[7:12,6] <-YNLecE_all[7:12,6]-sum(YNLecE_all[1:6,5])
YNLecE_all[19:24,6] <-YNLecE_all[19:24,6]-sum(YNLecE_all[13:18,5])
library(plyr)
YNLecZ_all <- ddply(YNLecZ_all, .(YNLecZ_YN),
transform, pos = cumsum(porcsYNLecZ) - (0.5 * porcsYNLecZ))
detach("package:plyr",unload = T)
YNLecZ_all[3:4,6] <-YNLecZ_all[3:4,6]-sum(YNLecZ_all[1:2,5])
YNLecZ_all[7:8,6] <-YNLecZ_all[7:8,6]-sum(YNLecZ_all[5:6,5])
cat <- c(rep("Zona",count(seis_YN_Z_all)),rep("Rango de edad",count(seis_YN_E_all)))
YNLecE_all <- data.frame(Fill=YNLecE_Edades,DI=YNLecE_DI,YN=YNLecE_YN,nums=numsYNLecE,porcs=porcsYNLecE)
library(plyr)
YNLecE_all <- ddply(YNLecE_all, .(YNLecE_YN),
transform, pos = cumsum(porcsYNLecE) - (0.5 * porcsYNLecE))
YNLecE_all <- data.frame(Fill=YNLecE_Edades,DI=YNLecE_DI,YN=YNLecE_YN,nums=numsYNLecE,porcs=porcsYNLecE)
library(plyr)
YNLecE_all <- ddply(YNLecE_all, .(YN),
transform, pos = cumsum(porcsYNLecE) - (0.5 * porcsYNLecE))
detach("package:plyr",unload = T)
YNLecE_all[7:12,6] <-YNLecE_all[7:12,6]-sum(YNLecE_all[1:6,5])
YNLecE_all[19:24,6] <-YNLecE_all[19:24,6]-sum(YNLecE_all[13:18,5])
ggplot(YNLecE_all, aes(x=factor(YNLecE_YN),y=porcsYNLecE,
fill=factor(YNLecE_Edades,levels=rev(c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años")))))+
geom_bar(stat='identity') +
theme_bw()+
scale_fill_brewer(palette ="Set3",direction=-1) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YNLecE_YN,y=pos,label=ifelse(porcsYNLecE>=33,paste0(round(porcsYNLecE,1),"%"),"")), size=3.5) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje relativo por rango de edad",
fill="Rango de Edad")+
facet_wrap(~YNLecE_DI)
ggplot(YNLecE_all, aes(x=factor(YN),y=porcs,
fill=factor(Fill,levels=rev(c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años")))))+
geom_bar(stat='identity') +
theme_bw()+
scale_fill_brewer(palette ="Set3",direction=-1) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YN,y=pos,label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),"")), size=3.5) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje relativo por rango de edad",
fill="Rango de Edad")+
facet_wrap(~DI)
YNLecE_all <- data.frame(Fill=YNLecE_Edades,DI=YNLecE_DI,YN=YNLecE_YN,nums=numsYNLecE,porcs=porcsYNLecE)
library(plyr)
YNLecE_all <- ddply(YNLecE_all, .(YN),
transform, pos = cumsum(porcs) - (0.5 * porcs))
detach("package:plyr",unload = T)
YNLecE_all[7:12,6] <-YNLecE_all[7:12,6]-sum(YNLecE_all[1:6,5])
YNLecE_all[19:24,6] <-YNLecE_all[19:24,6]-sum(YNLecE_all[13:18,5])
ggplot(YNLecE_all, aes(x=factor(YN),y=porcs,
fill=factor(Fill,levels=rev(c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años")))))+
geom_bar(stat='identity') +
theme_bw()+
scale_fill_brewer(palette ="Set3",direction=-1) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YN,y=pos,label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),"")), size=3.5) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje relativo por rango de edad",
fill="Rango de Edad")+
facet_wrap(~DI)
tres_plot_YNLecE
tres_plot_YNLecE
ggplot(YNLecZ_all, aes(x=factor(YN),y=porcs,
fill=factor(Fill,levels=c("Urbana","Rural"))))+
geom_bar(stat='identity') +
scale_fill_brewer(palette ="Pastel1") +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecZ_all,aes(x=YN,y=pos,label=paste0(round(porcs,1),"%")), size=4) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Frecuencia relativa por zona",
fill="Zona",
title="Lectura en soporte ... en los últimos 12 meses por zona")+
facet_wrap(~DI)
YNLecZ_all <- data.frame(Fill=YNLecZ_Zona,DI=YNLecZ_DI,YN=YNLecZ_YN,nums=numsYNLecZ,porcs=porcsYNLecZ)
library(plyr)
YNLecZ_all <- ddply(YNLecZ_all, .(YN),
transform, pos = cumsum(porcs) - (0.5 * porcs))
detach("package:plyr",unload = T)
YNLecZ_all[3:4,6] <-YNLecZ_all[3:4,6]-sum(YNLecZ_all[1:2,5])
YNLecZ_all[7:8,6] <-YNLecZ_all[7:8,6]-sum(YNLecZ_all[5:6,5])
ggplot(YNLecZ_all, aes(x=factor(YN),y=porcs,
fill=factor(Fill,levels=c("Urbana","Rural"))))+
geom_bar(stat='identity') +
scale_fill_brewer(palette ="Pastel1") +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecZ_all,aes(x=YN,y=pos,label=paste0(round(porcs,1),"%")), size=4) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Frecuencia relativa por zona",
fill="Zona",
title="Lectura en soporte ... en los últimos 12 meses por zona")+
facet_wrap(~DI)
cat <- c(rep("Zona",count(seis_YN_Z_all)),rep("Rango de edad",count(seis_YN_E_all)))
YNLec_all <- data.frame(cat,rbind(YNLecZ_all,YNLecE_all))
View(YNLec_all)
ggplot(YNLec_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(YNLec_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(YNLec_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(YNLec_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(rev(c(w,"#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(YNLec_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(YNLec_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría")+
facet_grid(cat~DI,scales="free")
ggplot(YNLec_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
theme_bw()+
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría")+
facet_grid(cat~DI,scales="free")
ggplot(YNLec_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
theme_bw()+
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",fill="")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
theme_dark()+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
theme_bw()+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
theme_linedraw()+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
theme_bw()+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
theme_bw()+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="Estrato")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
theme_bw()+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="")+
facet_grid(cat~DI,scales="free")
ggplot(diamonds) +
geom_bar(aes(clarity, fill = color,
# 1) set the border (i.e. the color aesthetic) based on whether the value
# of the relevant variable (which also happens to be called color) is D
color = color=='D')) +
# 2) use a scale such that FALSE is no color and TRUE is black,
# but don't include this in the legend
scale_color_manual(values = c(NA, 'black'), guide=F)
