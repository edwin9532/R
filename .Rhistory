# Plot
datas <- data %>%
left_join(sample_size) %>%
mutate(myaxis = paste0(name, "\n", "n=", num))
View(datas)
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
xlab("")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_density(stat="density")
ggplot(seis_IvD, aes(x=DI,y=nums)) +
geom_density(stat="density")
ggplot(seis_IvD, aes(x=DI, y=nums, fill=DI)) +
geom_boxplot(alpha=0.3) +
theme(legend.position="none") +
scale_fill_brewer(palette="BuPu")
ggplot(seis_IvD, aes(x=DI, y=nums, fill=DI)) +
geom_boxplot(alpha=0.3) +
scale_y_discrete(limits=0:50)+
theme(legend.position="none") +
scale_fill_brewer(palette="BuPu")
0:50
ggplot(seis_IvD, aes(x=DI, y=nums, fill=DI)) +
geom_boxplot(alpha=0.3) +
scale_y_discrete(limits=c(0:50))+
theme(legend.position="none") +
scale_fill_brewer(palette="BuPu")
ggplot(seis_IvD, aes(x=DI, y=nums, fill=DI)) +
geom_boxplot(alpha=0.3) +
scale_y_discrete(limits=factor)0:50))+
theme(legend.position="none") +
scale_fill_brewer(palette="BuPu")
ggplot(seis_IvD, aes(x=DI, y=nums, fill=DI)) +
geom_boxplot(alpha=0.3) +
scale_y_discrete(limits=factor(0:50))+
theme(legend.position="none") +
scale_fill_brewer(palette="BuPu")
ggplot(seis_IvD, aes(x=DI, y=nums, fill=DI)) +
geom_boxplot(alpha=0.3) +
scale_y_discrete(limits=factor(0:10))+
theme(legend.position="none") +
scale_fill_brewer(palette="BuPu")
quantile(base_LibsLe$N_Imp,.9)
quantile(base_LibsLe$N_Imp,.99)
ggplot(seis_IvD, aes(x=DI, y=nums, fill=DI)) +
geom_boxplot(alpha=0.3) +
scale_y_discrete(limits=factor(0:10))+
theme(legend.position="none") +
scale_fill_brewer(palette="BuPu")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
xlab("")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
facet_wrap(DI)
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
facet_wrap(DI)
ggplot(YNLecE_all, aes(x=factor(YN),y=porcs,
fill=factor(Fill,levels=rev(c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años")))))+
geom_bar(stat='identity') +
theme_bw()+
scale_fill_brewer(palette ="Set3",direction=-1) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YN,y=pos,label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),"")), size=3.5) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje relativo por rango de edad",
fill="Rango de Edad")+
facet_wrap(~DI)
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
facet_wrap(~DI)
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
facet_wrap(~DI,scales = c(1:5,1:10))
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
facet_wrap(~DI,scales = "free")+
scale_y_discrete(limits=factor(1:5,1:10))
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
scale_y_discrete(limits=factor(1:5,1:10))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 10))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 15))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="grey", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=0.07, color="white", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=1.5) +
geom_boxplot(width=1, color="white", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=2) +
geom_boxplot(width=1, color="white", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=.5) +
geom_boxplot(width=1, color="white", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=1, color="white", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="white", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="white", alpha=.1) +
#scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="white", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="black", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="blue", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="lightblue", alpha=.1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="lightblue", alpha=1) +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="white") +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI, y=nums, fill=DI)) +
geom_boxplot(alpha=0.3) +
scale_y_discrete(limits=factor(0:10))+
theme(legend.position="none") +
scale_fill_brewer(palette="BuPu")
ggplot(seis_IvD, aes(x=DI, y=nums, fill=DI)) +
geom_boxplot(alpha=0.3) +
scale_y_discrete(limits=factor(0:1))+
theme(legend.position="none") +
scale_fill_brewer(palette="BuPu")
ggplot(seis_IvD, aes(x=DI, y=nums, fill=DI)) +
geom_boxplot(alpha=0.3) +
scale_y_discrete(limits=c(0,0.5))+
theme(legend.position="none") +
scale_fill_brewer(palette="BuPu")
ggplot(seis_IvD, aes(x=DI, y=nums, fill=DI)) +
geom_boxplot(alpha=0.3) +
scale_y_discrete(limits=factor(0:10))+
theme(legend.position="none") +
scale_fill_brewer(palette="BuPu")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="white") +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="white") +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
theme_bw()+
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="gray") +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
theme_bw()+
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
mean(base_LibsLe$N_libros)
median(base_LibsLe$N_libros)
mean(base_LibsLe$N_Imp)
mean(base_LibsLe$N_Dig)
mean(base_LibsLe$N_Gusto)
mean(base_LibsLe$N_Trabajo)
base_LibsLe %>%
filter(N_libros!=0)
base_LibsLe %>%
filter(N_libros!=0) %>%
mean(N_Gusto)
base_LibsLeSí <-base_LibsLe %>%
filter(N_libros!=0)
View(base_LibsLeSí)
mean(base_LibsLeSí$N_Imp)
mean(base_LibsLeSí$N_Dig)
mean(base_LibsLeSí$N_Gusto)
mean(base_LibsLeSí$N_Trabajo)
sum(base_LibsLeSí$N_libros)
sum(base_LibsLeSí$N_Trabajo)
sum(base_LibsLeSí$N_Gusto)
sum(base_LibsLeSí$N_Gusto)/sum(base_LibsLeSí$N_libros)
sum(base_LibsLeSí$N_Trabajo)/sum(base_LibsLeSí$N_libros)
mean(base_LibsLeSí$N_Imp)
mean(base_LibsLeSí$N_Dig)
mean(base_LibsLeSí$N_Gusto)
mean(base_LibsLeSí$N_Trabajo)
median(base_LibsLeSí$N_Imp)
mean(base_LibsLe$N_libros)
median(base_LibsLe$N_Imp)
quantile(base_LibsLe$N_Imp,.99)
mean(base_LibsLeSí$N_Imp)
median(base_LibsLeSí$N_Imp)
sum(base_LibsLeSí$N_Trabajo)/sum(base_LibsLeSí$N_libros)
sum(base_LibsLeSí$N_Gusto)/sum(base_LibsLeSí$N_libros)
sum(base_LibsLeSí$N_Dig)/sum(base_LibsLeSí$N_libros)
sum(base_LibsLeSí$N_Imp)/sum(base_LibsLeSí$N_libros)
sum(base_LibsLeSí$N_Trabajo)/sum(base_LibsLeSí$N_Imp)
sum(base_LibsLeSí$N_Gusto)/sum(base_LibsLeSí$N_Dig)
sum(base_LibsLeSí$N_Dig)/sum(base_LibsLeSí$N_libros)
sum(base_LibsLeSí$N_Gusto)/sum(base_LibsLeSí$N_libros)
base_LibsLe <- base_re %>%
filter(P4031S1A1!=1010&P4031S1A1!=0&P4031S1A1!=9) %>% # ~1% de personas excluidas por estrato no especificado o ambiguo(pirata,no se puede establecer)
select(RangosEdad,DOMINIO,P4031S1A1,P5381,P210,P211,P1863S1,P1863S2)
colnames(base_LibsLe) <- c("Rango_de_edad","Zona","Estrato","N_libros","N_Imp","N_Dig","N_Gusto","N_Trabajo")
base_LibsLe[base_LibsLe==1010] <- 0
sum(base_LibsLe$N_libros==0)
count(base_LibsLe)[1,1]
sum(base_LibsLe$N_libros==0)/count(base_LibsLe)[1,1]
base_LibsLe <- base_re %>%
filter(P4031S1A1!=1010&P4031S1A1!=0&P4031S1A1!=9) %>% # ~1% de personas excluidas por estrato no especificado o ambiguo(pirata,no se puede establecer)
select(RangosEdad,DOMINIO,P4031S1A1,P5381,P210,P211,P1863S1,P1863S2)
colnames(base_LibsLe) <- c("Rango_de_edad","Zona","Estrato","N_libros","N_Imp","N_Dig","N_Gusto","N_Trabajo")
base_LibsLe[base_LibsLe==1010] <- 0
sum(base_LibsLe$N_libros==0)/count(base_LibsLe)[1,1]
sum(base_LibsLe$N_libros==0|base_LibsLe$N_libros==1)/count(base_LibsLe)[1,1]
sum(base_LibsLe$N_libros==0)/count(base_LibsLe)[1,1]
ggplot(seis_IvD, aes(x=DI,y=nums)) +
geom_density(stat="density")
ggplot(seis_IvD, aes(x=DI,y=nums,fill=DI)) +
geom_violin(width=3) +
geom_boxplot(width=.5, color="gray") +
scale_fill_viridis(discrete = TRUE) +
theme(plot.title = element_text(size=11)) +
theme_bw()+
ggtitle("A Violin wrapping a boxplot") +
coord_cartesian(ylim = c(-1, 12))+
facet_wrap(~DI,scales = "free")
base_LecFrec <- base_re %>%
filter(P5381!=1010) %>%
select(P1858S1,P5380S1)
View(base_LecFrec)
count(base_LibsLe)[1,1]
sum(base_LibsLe$N_libros==0)
sum(base_LibsLe$N_libros=!0)
sum(base_LibsLe$N_libros!=0)
base_LecFrec <- base_re %>%
filter(P5381!=1010,P4031S1A1!=1010&P4031S1A1!=0&P4031S1A1!=9) %>%
select(P1858S1,P5380S1)
base_LibsLeSí <-base_LibsLe %>%
filter(N_libros!=0)
seis_YN_Zona <- base_LibsLe %>%
filter(N_libros!=0) %>%
group_by(Zona) %>%
summarise(DigSí=sum(N_Dig!=0),DigNo=sum(N_Dig==0),ImpSí=sum(N_Imp!=0),ImpNo=sum(N_Imp==0))
YNZnums <- c()
for(i in 2:5){
YNZnums <- c(YNZnums,pull(seis_YN_Zona,i)) # Une datos numéricos de nivs de educ en un solo vector
}
YNZporcs <- YNZnums/c(sum(base_LibsLeSí$Zona==1),sum(base_LibsLeSí$Zona==2))*100
YNZ_DI <- c(rep("Digital",4),rep("Impreso",4))
YNZ_Z <- rep(c("Urbana","Rural"),4)
YNZ_YN <- rep(c(rep("Sí",2),rep("No",2)),2)
seis_YN_Z_all <- data.frame(Fill=YNZ_Z,DI=YNZ_DI,YN=YNZ_YN,nums=YNZnums,porcs=YNZporcs)
seis_YN_Edad <- base_LibsLe %>%
filter(N_libros!=0) %>%
group_by(Rango_de_edad) %>%
summarise(DigSí=sum(N_Dig!=0),DigNo=sum(N_Dig==0),ImpSí=sum(N_Imp!=0),ImpNo=sum(N_Imp==0))
seis_YN_Edad <- rbind(seis_YN_Edad[6,],seis_YN_Edad[1:5,])
YNEnums <- c()
for(i in 2:5){
YNEnums <- c(YNEnums,pull(seis_YN_Edad,i)) # Une datos numéricos de nivs de educ en un solo vector
}
pobsEdad <- c(sum(base_LibsLeSí$Rango_de_edad =="Menor de 18 años"),sum(base_LibsLeSí$Rango_de_edad=="De 18 a 24 años"),
sum(base_LibsLeSí$Rango_de_edad=="De 25 a 34 años"),sum(base_LibsLeSí$Rango_de_edad=="De 35 a 44 años"),
sum(base_LibsLeSí$Rango_de_edad=="De 45 a 54 años"),sum(base_LibsLeSí$Rango_de_edad=="Mayor de 55 años"))
YNEporcs <- YNEnums/pobsEdad*100
YNE_DI <- c(rep("Digital",12),rep("Impreso",12))
YNE_E <- rep(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"),4)
YNE_YN <- rep(c(rep("Sí",6),rep("No",6)),2)
seis_YN_E_all <- data.frame(Fill=YNE_E,DI=YNE_DI,YN=YNE_YN,nums=YNEnums,porcs=YNEporcs)
seis_YN_Estrato <- base_LibsLe %>%
filter(N_libros!=0) %>%
group_by(Estrato) %>%
summarise(DigSí=sum(N_Dig!=0),DigNo=sum(N_Dig==0),ImpSí=sum(N_Imp!=0),ImpNo=sum(N_Imp==0))
YNEsnums <- c()
for(i in 2:5){
YNEsnums <- c(YNEsnums,pull(seis_YN_Estrato,i)) # Une datos numéricos de nivs de educ en un solo vector
}
p <- c()
for(i in 1:6){
p = c(p,sum(base_LibsLeSí$Estrato==i))
}
pobsEstrato <- rep(p,4)
YNEsporcs <- YNEsnums/pobsEstrato*100
YNEs_DI <- c(rep("Digital",12),rep("Impreso",12))
YNEs_Es <- rep(1:6,4)
YNEs_YN <- rep(c(rep("Sí",6),rep("No",6)),2)
seis_YN_Es_all <- data.frame(Fill=YNEs_Es,DI=YNEs_DI,YN=YNEs_YN,nums=YNEsnums,porcs=YNEsporcs)
cat <- c(rep("Zona",count(seis_YN_Z_all)),rep("Rango de edad",count(seis_YN_E_all)),rep("Estrato",count(seis_YN_Es_all)))
seis_YN_all <- data.frame(cat,rbind(seis_YN_Z_all,seis_YN_E_all,seis_YN_Es_all))
w <-"white"
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
theme_bw()+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="")+
facet_grid(cat~DI,scales="free")
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
theme_bw()+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="")+
facet_grid(cat~DI,scales="free",ncol=2)
ggplot(seis_YN_all, aes(x=YN,y=porcs,fill=factor(Fill,levels=c("Estrato",c(6:1),"","Rango de edad",
rev(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años"))," ","Zona",c("Urbana","Rural"),
"  ","   ","    ","     ")),label=ifelse(porcs>=44.5,paste0(round(porcs,1),"%"),""))) +
#geom_text(data=seis_YN_all,size = 3, position = position_stack(vjust = 0.5),label=ifelse(porcs>=33,paste0(round(porcs,1),"%"),""))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
scale_fill_manual(values=c(w,"#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63",w,w,rev(c("#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462")),w,w,"#FBB4AE","#B3CDE3",w,w,w,w,w),
drop=F) +
guides(fill=guide_legend(ncol=1)) +
theme(legend.position="right",
legend.key = element_rect(fill=NA),
legend.title=element_blank())+
theme_bw()+
labs(x="¿Ha leído libros en formato ... en los últimos 12 meses?",y="Porcentaje del total de cada categoría",
fill="")+
facet_grid(cat~DI,scales="free")
sum(base_LibsLe$N_libros!=0)
sum(base_LibsLe$N_libros!=0)/count(base_LibsLe)[1,1]
94632-52484
sum(base_re$P5381==0)
sum(base_re$P5381==1010)
sum(base_LibsLe$N_libros!=0)/count(base_LibsLe)[1,1]
mean(base_LibsLe$N_libros)
mean(base_LibsLeSí$N_libros)
median(base_LibsLeSí$N_libros)
median(base_LibsLe$N_libros)
View(base_LibsLeSí)
