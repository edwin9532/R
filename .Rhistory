Uso = sum(`No sabe usar dispositivos`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Impreso=sum(`Prefiere impreso`==1),Otra=sum(Otra==1))
f_razonesD1
f_razonesD1/sum(base_RazNoLecDig$DOMINIO!=0)*100
f_razonesD <- base_RazNoLecDig %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1), Dinero = sum(Dinero==1),
Salud = sum(Salud ==1), Pereza = sum(Pereza==1), Falta_dis = sum(`No tiene dispositivos`==1),
Duda = sum(`Duda qué leer`==1), Internet = sum(`Acceso a internet`==1),
Uso = sum(`No sabe usar dispositivos`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Impreso=sum(`Prefiere impreso`==1),Otra=sum(Otra==1))
f_razonesD <- f_razonesD/sum(base_RazNoLecDig$DOMINIO!=0)*100
View(f_razonesD)
sum(base_RazNoLecDig$DOMINIO!=0)
base_RazNoLecImp <- base_re %>%
filter(P1865S1!=1010) %>%
select(RangosEdad,DOMINIO,P260,P4031S1A1,42,44:51,43)
razonesI <- c("Otras preferencias","Tiempo","Desinterés","Pereza","Dinero","Duda qué leer",
"Salud","Acceso a material","Prefiere digital","Otra")
names(base_RazNoLecImp)[5:14] <- razonesI # Cambia nombres de las razones
f_razonesI <- base_RazNoLecImp %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Pereza=sum(Pereza==1),Dinero = sum(Dinero==1),
Duda=sum(`Duda qué leer`==1),Salud=sum(Salud==1),Acceso=sum(`Acceso a material`==1),
Digital=sum(`Prefiere digital`==1),Otra=sum(Otra==1))
f_razonesI <- f_razonesI/sum(base_RazNoLecImp$DOMINIO!=0)*100
f_razonesI
tres_plot_DigPorcs <- ggplot(tres_Dig, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=porcsD, x=reorder(razonesD_,porcsD))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(porcsD>25,paste0(round(porcsD,1),"%"),""))+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razones por las que no lee digital",y="Porcentaje relativo por rango de edad",fill="Rango de Edad")
tres_plot_DigPorcs
tres_plot_DigZfrac <- ggplot(tres_DigZ, aes(fill=factor(DOMINIO,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsDZ_frac, x=reorder(razonesDZ,numsDZ_frac))) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black") +
geom_text(data=tres_DigZ,aes(x=razonesDZ,y=pos,label =ifelse(numsDZ_frac>=6,
paste0(numsDZ_frac,"%"),"")), family="serif",size = 4) +
coord_flip()+
scale_fill_brewer(palette ="Pastel1") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Porcentaje del total de personas de esa zona",fill="Zona") # Barras apiladas
tres_plot_DigZfrac
tres_plot_DigZfrac <- ggplot(tres_DigZ, aes(fill=factor(DOMINIO,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsDZ_frac, x=reorder(razonesDZ,numsDZ_frac))) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black") +
geom_text(data=tres_DigZ,aes(x=razonesDZ,y=pos,label =ifelse(numsDZ_frac>=6,
paste0(numsDZ_frac,"%"),"")), family="serif",size = 4) +
coord_flip()+
scale_fill_brewer(palette ="Pastel1") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razones por las que no lee digital",y="Porcentaje del total de personas de esa zona",fill="Zona") # Barras apiladas
tres_plot_DigZfrac
tres_plot_ImpPorcs <- ggplot(tres_Imp, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=porcsI, x=reorder(razonesI_,porcsI))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(porcsI>20,paste0(round(porcsI,1),"%"),""))+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razones por las que no lee impreso",y="Porcentaje relativo por rango de edad",fill="Rango de Edad") # Barras apiladas
tres_plot_ImpPorcs
base_NiñezEdu <- base_re %>% # Selecciona variables necesarias, excluye <18 por su educación
filter(RangosEdad!="Menor de 18 años") %>%
select(ID,RangosEdad,DOMINIO,P260,P4031S1A1,11:16)
tres_plot_ImpZfrac <- ggplot(tres_ImpZ, aes(fill=factor(DOMINIO,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsIZ_frac, x=reorder(razonesIZ,numsIZ_frac))) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black") +
geom_text(data=tres_ImpZ,aes(x=razonesIZ,y=pos,label =ifelse(numsIZ_frac>=6,
paste0(numsIZ_frac,"%"),"")), family="serif",size = 4) +
coord_flip()+
scale_fill_brewer(palette ="Pastel1") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee impreso",y="Porcentaje del total de personas de esa zona",fill="Zona") # Barras apiladas
tres_plot_ImpZfrac <- ggplot(tres_ImpZ, aes(fill=factor(DOMINIO,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsIZ_frac, x=reorder(razonesIZ,numsIZ_frac))) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black") +
geom_text(data=tres_ImpZ,aes(x=razonesIZ,y=pos,label =ifelse(numsIZ_frac>=6,
paste0(numsIZ_frac,"%"),"")), family="serif",size = 4) +
coord_flip()+
scale_fill_brewer(palette ="Pastel1") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razones por las que no lee impreso",y="Porcentaje del total de personas de esa zona",fill="Zona") # Barras apiladas
tres_plot_ImpZfrac
base_re$P1864S1!=1010
sum(base_re$DOMINIO==1&base_re$P1864S1!=1010
sum(base_re$DOMINIO==1&base_re$P1864S1!=1010)
library(wesanderson)
library(hrbrthemes)
library(RColorBrewer)
library(openxlsx)
library(dplyr)
library(summarytools)
library(ggplot2)
sum(base_re$DOMINIO==1&base_re$P1864S1!=1010)
sum(base_re$DOMINIO==2&base_re$P1864S1!=1010)
sum(base_re$DOMINIO==1&base_re$P1864S1!=1010)+sum(base_re$DOMINIO==2&base_re$P1864S1!=1010)
tres_plot_ImpZfrac <- ggplot(tres_ImpZ, aes(fill=factor(DOMINIO,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsIZ_frac, x=reorder(razonesIZ,numsIZ_frac))) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black") +
geom_text(data=tres_ImpZ,aes(x=razonesIZ,y=pos,label =ifelse(numsIZ_frac>=6,
paste0(numsIZ_frac,"%"),"")), family="serif",size = 4) +
coord_flip()+
scale_fill_brewer(palette ="Pastel1") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razones por las que no lee impreso",y="Porcentaje del total de personas de esa zona que no lee",fill="Zona") # Barras apiladas
tres_plot_ImpZfrac
theme_set(theme_linedraw(base_size = 14))
theme_update(panel.grid.major=element_line(colour="#808080"),panel.grid.minor=element_line(colour="gray"),panel.background=element_rect(fill=("#fff4e6")),text=element_text(size=14,family="serif"))
w <-"white"
tres_plot_DigZfrac <- ggplot(tres_DigZ, aes(fill=factor(DOMINIO,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsDZ_frac, x=reorder(razonesDZ,numsDZ_frac))) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black") +
geom_text(data=tres_DigZ,aes(x=razonesDZ,y=pos,label =ifelse(numsDZ_frac>=6,
paste0(numsDZ_frac,"%"),"")), family="serif",size = 4) +
coord_flip()+
scale_fill_brewer(palette ="Pastel1") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razones por las que no lee digital",y="Porcentaje del total de personas de esa zona que no lee",fill="Zona") # Barras apiladas
tres_plot_DigZfrac
tres_plot_ImpZfrac
f_razonesD <- f_razonesD/sum(base_RazNoLecDig$DOMINIO!=0)*100 # Frecuencia de las razones digital
f_razonesD
f_razonesD <- base_RazNoLecDig %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1), Dinero = sum(Dinero==1),
Salud = sum(Salud ==1), Pereza = sum(Pereza==1), Falta_dis = sum(`No tiene dispositivos`==1),
Duda = sum(`Duda qué leer`==1), Internet = sum(`Acceso a internet`==1),
Uso = sum(`No sabe usar dispositivos`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Impreso=sum(`Prefiere impreso`==1),Otra=sum(Otra==1))
f_razonesD <- f_razonesD/sum(base_RazNoLecDig$DOMINIO!=0)*100 # Frecuencia de las razones digital
f_razonesD
View(cuat_punts)
View(base_NiñezEdu)
View(cuat_NE_plot)
cuat_NE_plot
f_punts <- cuat_punts %>%
freq(Puntaje,report.nas=FALSE)
cuat_NivZona <- base_NiñezEdu %>%
group_by(DOMINIO) %>%
summarise(Ninguna=sum(Educación==0),Preescolar=sum(Educación==1),`Básica primaria`=sum(Educación==2),
`Básica secundaria`=sum(Educación==3),`Media académica`=sum(Educación==4),
`Media técnica`=sum(Educación==5),Normalista=sum(Educación==6),`Técnica`=sum(Educación==7),
`Tecnológica`=sum(Educación==8),Universitario=sum(Educación==9),Especialización=sum(Educación==10),
Maestría=sum(Educación==11),Doctorado=sum(Educación==12))
f_punts <- cuat_punts %>%
freq(Puntaje,report.nas=FALSE)
library(wesanderson)
library(hrbrthemes)
library(RColorBrewer)
library(openxlsx)
library(dplyr)
library(summarytools)
library(ggplot2)
f_punts <- cuat_punts %>%
freq(Puntaje,report.nas=FALSE)
f_punts
f_punts <- cuat_punts %>%
group_by(RangosEdad) %>%
freq(Puntaje,report.nas=FALSE)
f_punts
f_punts <- cuat_punts %>%
freq(Puntaje,report.nas=FALSE)
f_punts
cuat_punts[,4]
mean(cuat_punts[,4])
mean(c(cuat_punts[,4]))
pull(cuat_punts[,4])
mean(pull(cuat_punts[,4]))
median(pull(cuat_punts[,4]))
punts_prom_edad <- cuat_punts %>%
group_by(RangosEdad) %>%
summarise(mean(Puntaje))
punts_prom_edad
base_NiñezEdu <- base_re %>% # Selecciona variables necesarias, excluye <18 por su educación
#filter(RangosEdad!="Menor de 18 años") %>%
select(ID,RangosEdad,DOMINIO,P260,P4031S1A1,11:16)
cuat_noms <- c("Educación","Estrato","Iba a bibliotecas",
"Iba a librerías","Veía leer",
"Le leían","Profs motivaban leer",
"Profs motivaban ir a bibs")
names(base_NiñezEdu)[4:11] <- cuat_noms # Cambia nombres de columnas
cuat_punts <- base_NiñezEdu %>% # Crea puntaje para cada persona
group_by(ID) %>%
summarise(RangosEdad = RangosEdad,Educacion = Educación,
Puntaje = sum(`Iba a bibliotecas`==1)+sum(`Iba a librerías`==1)+sum(`Veía leer`==1)+
sum(`Le leían`==1)+sum(`Profs motivaban leer`==1)+sum(`Profs motivaban ir a bibs`==1))
f_punts <- cuat_punts %>%
freq(Puntaje,report.nas=FALSE)
f_punts
mean(pull(cuat_punts[,4]))
punts_prom_edad <- cuat_punts %>%
group_by(RangosEdad) %>%
summarise(mean(Puntaje))
punts_prom_edad
view(punts_prom_edad)
(11620 + 2*21899 + 3*14810 + 4*16316 + 5*7736 + 6*10836)/96442
view(f_punts)
View(cuat_all)
cuat_NZ_plot
cuat_NivZona <- base_NiñezEdu %>%
group_by(DOMINIO) %>%
summarise(Ninguna=sum(Educación==0),Preescolar=sum(Educación==1),`Básica primaria`=sum(Educación==2),
`Básica secundaria`=sum(Educación==3),`Media académica`=sum(Educación==4),
`Media técnica`=sum(Educación==5),Normalista=sum(Educación==6),`Técnica`=sum(Educación==7),
`Tecnológica`=sum(Educación==8),Universitario=sum(Educación==9),Especialización=sum(Educación==10),
Maestría=sum(Educación==11),Doctorado=sum(Educación==12))
numsNivZ <- c()
for(i in 2:14){
numsNivZ <- c(numsNivZ,pull(cuat_NivZona,i)) # Une datos numéricos de nivs de educ en un solo vector
}
numsNivZ_porc <- round(numsNivZ/c(sum(base_re$DOMINIO==1&base_re$RangosEdad!="Menor de 18 años"),
sum(base_re$DOMINIO==2&base_re$RangosEdad!="Menor de 18 años"))*100,1) # Calcula fracción que representa del total de esa zona
for(i in 0:12){
t <- numsNivZ_porc[2*i+2]
numsNivZ_porc[2*i+2] <- numsNivZ_porc[2*i+1]
numsNivZ_porc[2*i+1] <- t
}
doms <- rep(c(2:1),13)
NivsZ <- c(rep("Ninguna",2),rep("Preescolar",2),rep("Básica primaria",2),
rep("Básica secundaria",2),rep("Media académica",2),rep("Media técnica",2),
rep("Normalista",2),rep("Técnica",2),rep("Tecnológica",2),rep("Universitario",2),
rep("Especialización",2),rep("Maestría",2),rep("Doctorado",2))
cuat_NZ_all <- data.frame(doms,NivsZ,numsNivZ_porc)
library(plyr)
cuat_NZ_all <- ddply(cuat_NZ_all, .(NivsZ),
transform, pos = cumsum(numsNivZ_porc) - (0.5 * numsNivZ_porc))
detach("package:plyr",unload = T)
cuat_NZ_plot <- ggplot(cuat_NZ_all, aes(fill=factor(doms,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsNivZ_porc, x=factor(NivsZ,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(data=cuat_NZ_all,aes(x=NivsZ,y=pos,label =ifelse(numsNivZ_porc>3.5,
paste0(numsNivZ_porc,"%"),"")), family="serif",size = 3.5) +
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NZ_plot
View(cuat_NivZona)
numsNivZ
doms <- rep(c(1:2),13)
doms
cuat_NZ_plot <- ggplot(cuat_NZ_all, aes(fill=factor(doms,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsNivZ_porc, x=factor(NivsZ,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivZ_porc>10,paste0(round(numsNivZ_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NZ_plot
View(cuat_NZ_all)
cuat_NZ_all <- data.frame(doms,NivsZ,numsNivZ_porc)
cuat_NZ_plot <- ggplot(cuat_NZ_all, aes(fill=factor(doms,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsNivZ_porc, x=factor(NivsZ,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivZ_porc>10,paste0(round(numsNivZ_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NZ_plot
numsNivZ_porc <- round(numsNivZ/c(sum(base_re$DOMINIO==1&base_re),
sum(base_re$DOMINIO==2&base_re))*100,1) # Calcula fracción que representa del total de esa zona
doms <- rep(c(1:2),13)
NivsZ <- c(rep("Ninguna",2),rep("Preescolar",2),rep("Básica primaria",2),
rep("Básica secundaria",2),rep("Media académica",2),rep("Media técnica",2),
rep("Normalista",2),rep("Técnica",2),rep("Tecnológica",2),rep("Universitario",2),
rep("Especialización",2),rep("Maestría",2),rep("Doctorado",2))
cuat_NZ_all <- data.frame(doms,NivsZ,numsNivZ_porc)
cuat_NZ_plot <- ggplot(cuat_NZ_all, aes(fill=factor(doms,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsNivZ_porc, x=factor(NivsZ,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivZ_porc>10,paste0(round(numsNivZ_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NZ_plot
numsNivZ <- c()
for(i in 2:14){
numsNivZ <- c(numsNivZ,pull(cuat_NivZona,i)) # Une datos numéricos de nivs de educ en un solo vector
}
numsNivZ_porc <- round(numsNivZ/c(sum(base_re$DOMINIO==1&base_re),
sum(base_re$DOMINIO==2&base_re))*100,1) # Calcula fracción que representa del total de esa zona
doms <- rep(c(1:2),13)
NivsZ <- c(rep("Ninguna",2),rep("Preescolar",2),rep("Básica primaria",2),
rep("Básica secundaria",2),rep("Media académica",2),rep("Media técnica",2),
rep("Normalista",2),rep("Técnica",2),rep("Tecnológica",2),rep("Universitario",2),
rep("Especialización",2),rep("Maestría",2),rep("Doctorado",2))
cuat_NZ_all <- data.frame(doms,NivsZ,numsNivZ_porc)
cuat_NZ_plot <- ggplot(cuat_NZ_all, aes(fill=factor(doms,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsNivZ_porc, x=factor(NivsZ,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivZ_porc>10,paste0(round(numsNivZ_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NZ_plot
numsNivZ_porc <- round(numsNivZ/c(sum(base_re$DOMINIO==1),
sum(base_re$DOMINIO==2))*100,1) # Calcula fracción que representa del total de esa zona
doms <- rep(c(1:2),13)
NivsZ <- c(rep("Ninguna",2),rep("Preescolar",2),rep("Básica primaria",2),
rep("Básica secundaria",2),rep("Media académica",2),rep("Media técnica",2),
rep("Normalista",2),rep("Técnica",2),rep("Tecnológica",2),rep("Universitario",2),
rep("Especialización",2),rep("Maestría",2),rep("Doctorado",2))
cuat_NZ_all <- data.frame(doms,NivsZ,numsNivZ_porc)
cuat_NZ_plot <- ggplot(cuat_NZ_all, aes(fill=factor(doms,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsNivZ_porc, x=factor(NivsZ,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivZ_porc>10,paste0(round(numsNivZ_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NZ_plot
base_NiñezEdu <- base_re %>% # Selecciona variables necesarias, excluye <18 por su educación
filter(RangosEdad!="Menor de 18 años") %>%
select(ID,RangosEdad,DOMINIO,P260,P4031S1A1,11:16)
cuat_noms <- c("Educación","Estrato","Iba a bibliotecas",
"Iba a librerías","Veía leer",
"Le leían","Profs motivaban leer",
"Profs motivaban ir a bibs")
names(base_NiñezEdu)[4:11] <- cuat_noms # Cambia nombres de columnas
cuat_NivZona <- base_NiñezEdu %>%
group_by(DOMINIO) %>%
summarise(Ninguna=sum(Educación==0),Preescolar=sum(Educación==1),`Básica primaria`=sum(Educación==2),
`Básica secundaria`=sum(Educación==3),`Media académica`=sum(Educación==4),
`Media técnica`=sum(Educación==5),Normalista=sum(Educación==6),`Técnica`=sum(Educación==7),
`Tecnológica`=sum(Educación==8),Universitario=sum(Educación==9),Especialización=sum(Educación==10),
Maestría=sum(Educación==11),Doctorado=sum(Educación==12))
numsNivZ <- c()
for(i in 2:14){
numsNivZ <- c(numsNivZ,pull(cuat_NivZona,i)) # Une datos numéricos de nivs de educ en un solo vector
}
numsNivZ_porc <- round(numsNivZ/c(sum(base_re$DOMINIO==1),
sum(base_re$DOMINIO==2))*100,1) # Calcula fracción que representa del total de esa zona
doms <- rep(c(1:2),13)
NivsZ <- c(rep("Ninguna",2),rep("Preescolar",2),rep("Básica primaria",2),
rep("Básica secundaria",2),rep("Media académica",2),rep("Media técnica",2),
rep("Normalista",2),rep("Técnica",2),rep("Tecnológica",2),rep("Universitario",2),
rep("Especialización",2),rep("Maestría",2),rep("Doctorado",2))
cuat_NZ_all <- data.frame(doms,NivsZ,numsNivZ_porc)
cuat_NZ_plot <- ggplot(cuat_NZ_all, aes(fill=factor(doms,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsNivZ_porc, x=factor(NivsZ,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivZ_porc>10,paste0(round(numsNivZ_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NZ_plot
numsNivZ_porc <- round(numsNivZ/c(sum(base_NiñezEdu$DOMINIO==1),
sum(base_NiñezEdu$DOMINIO==2))*100,1) # Calcula fracción que representa del total de esa zona
doms <- rep(c(1:2),13)
NivsZ <- c(rep("Ninguna",2),rep("Preescolar",2),rep("Básica primaria",2),
rep("Básica secundaria",2),rep("Media académica",2),rep("Media técnica",2),
rep("Normalista",2),rep("Técnica",2),rep("Tecnológica",2),rep("Universitario",2),
rep("Especialización",2),rep("Maestría",2),rep("Doctorado",2))
cuat_NZ_all <- data.frame(doms,NivsZ,numsNivZ_porc)
cuat_NZ_plot <- ggplot(cuat_NZ_all, aes(fill=factor(doms,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsNivZ_porc, x=factor(NivsZ,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivZ_porc>10,paste0(round(numsNivZ_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NZ_plot
cuat_NZ_plot <- ggplot(cuat_NZ_all, aes(fill=factor(doms,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsNivZ_porc, x=factor(NivsZ,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivZ_porc>5,paste0(round(numsNivZ_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NZ_plot
cuat_NE_plot
View(base_TiLecEst)
cinco_plot_YNEstPorc <- ggplot(cinco_YNEst_all, aes(x=YN,y=YNPorcs,fill=factor(YNEs,levels=c(1:6)))) +
geom_bar(stat='identity') +
#scale_fill_brewer(palette ="Set3",direction=-1) +
scale_fill_manual(values=c("#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63"))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(YNPorcs>50,paste0(round(YNPorcs,1),"%"),""))+
labs(x="¿Ha leído ... en los últimos 12 meses?",y="Porcentaje del total de cada estrato",
fill="Estrato")+#title="Lectura en los últimos 12 meses por estrato")+
facet_wrap(~factor(YNpregs,levels=c("Redes sociales","Periódicos impresos",
"Documentos académicos impresos","Documentos académicos digitales","Páginas web")))
library(wesanderson)
library(hrbrthemes)
library(RColorBrewer)
library(openxlsx)
library(dplyr)
library(summarytools)
library(ggplot2)
theme_set(theme_linedraw(base_size = 14))
theme_update(panel.grid.major=element_line(colour="#808080"),panel.grid.minor=element_line(colour="gray"),panel.background=element_rect(fill=("#fff4e6")),text=element_text(size=14,family="serif"))
cinco_plot_YNEstPorc <- ggplot(cinco_YNEst_all, aes(x=YN,y=YNPorcs,fill=factor(YNEs,levels=c(1:6)))) +
geom_bar(stat='identity') +
#scale_fill_brewer(palette ="Set3",direction=-1) +
scale_fill_manual(values=c("#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63"))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(YNPorcs>50,paste0(round(YNPorcs,1),"%"),""))+
labs(x="¿Ha leído ... en los últimos 12 meses?",y="Porcentaje del total de cada estrato",
fill="Estrato")+#title="Lectura en los últimos 12 meses por estrato")+
facet_wrap(~factor(YNpregs,levels=c("Redes sociales","Periódicos impresos",
"Documentos académicos impresos","Documentos académicos digitales","Páginas web")))
cinco_plot_YNEstPorc
cinco_plot_YNEstPorc <- ggplot(cinco_YNEst_all, aes(x=YN,y=YNPorcs,fill=factor(YNEs,levels=c(6:1)))) +
geom_bar(stat='identity') +
#scale_fill_brewer(palette ="Set3",direction=-1) +
scale_fill_manual(values=c("#74ADD1","#ABD9E9", "#E0F3F8", "#D9EF8B","#A6D96A","#66BD63"))+
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(YNPorcs>50,paste0(round(YNPorcs,1),"%"),""))+
labs(x="¿Ha leído ... en los últimos 12 meses?",y="Porcentaje del total de cada estrato",
fill="Estrato")+#title="Lectura en los últimos 12 meses por estrato")+
facet_wrap(~factor(YNpregs,levels=c("Redes sociales","Periódicos impresos",
"Documentos académicos impresos","Documentos académicos digitales","Páginas web")))
cinco_plot_YNEstPorc
View(cinco_P1)
View(base_TiLecEst)
cinco_frecs <- data.frame()
data.frame(c(1,2,3,4,5),c(5,4,3,2,1))
base_TiLecEst[,3]
Sí <- c()
No <- c()
for (i in 3:7){
Sí <- c(Sí,sum(base_TiLecEst[,i]!=1010))
No <- c(No,sum(base_TiLecEst[,i]==1010))
}
Sí
No
Sí+No
cinco_frecs <- data.frame(YNpregs_,Sí,No)
YNpregs_ <- c("Redes sociales","Periódicos impresos","Documentos académicos impresos",
"Documentos académicos digitales","Páginas web")
cinco_frecs <- data.frame(YNpregs_,Sí,No)
cinco_frecs
cinco_frecs <- data.frame(YNpregs_,Sí/2,No)
cinco_frecs
base_TiLecEst(n())
n(base_TiLecEst)
nrow(base_TiLecEst)
cinco_frecs <- data.frame(YNpregs_,Sí/nrow(base_TiLecEst),No/nrow(base_TiLecEst))
cinco_frecs <- data.frame(YNpregs_,Sí/nrow(base_TiLecEst)*100,No/nrow(base_TiLecEst)*100)
cinco_frecs
cinco_frecs <- data.frame(YNpregs_,"Sí"=Sí/nrow(base_TiLecEst)*100,"No"=No/nrow(base_TiLecEst)*100)
cinco_frecs
view(f_Est)
view(f_punts)
f_Est
