geom_bar(stat='identity') +
scale_fill_brewer(palette ="Set3") +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YNLecE_YN,y=pos,label=ifelse(porcsYNLecE>=33,paste0(round(porcsYNLecE,1),"%"),"")), size=4) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Frecuencia relativa por rango de edad",
fill="Rango de Edad",
title="Lectura en soporte ... en los últimos 12 meses por zona")+
facet_wrap(~YNLecE_DI)
ggplot(YNLecE_all, aes(x=factor(YNLecE_YN),y=porcsYNLecE,
fill=factor(YNLecE_Edades,levels=c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años"))))+
geom_bar(stat='identity') +
scale_fill_brewer(palette ="Set3") +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YNLecE_YN,y=pos,label=ifelse(porcsYNLecE>=33,paste0(round(porcsYNLecE,1),"%"),"")), size=4) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Frecuencia relativa por rango de edad",
fill="Rango de Edad",
title="Lectura en soporte ... en los últimos 12 meses por edad")+
facet_wrap(~YNLecE_DI)
ggplot(YNLecE_all, aes(x=factor(YNLecE_YN),y=porcsYNLecE,
fill=factor(YNLecE_Edades,levels=c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años"))))+
geom_bar(stat='identity') +
scale_fill_brewer(palette ="Set3") +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YNLecE_YN,y=pos,label=ifelse(porcsYNLecE>=33,paste0(round(porcsYNLecE,1),"%"),"")), size=4) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje relativo por rango de edad",
fill="Rango de Edad",
title="Lectura en soporte ... en los últimos 12 meses por edad")+
facet_wrap(~YNLecE_DI)
ggplot(YNLecE_all, aes(x=factor(YNLecE_YN),y=porcsYNLecE,
fill=factor(YNLecE_Edades,levels=c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años"))))+
geom_bar(stat='identity') +
scale_fill_brewer(palette ="Set3",direction=-1) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YNLecE_YN,y=pos,label=ifelse(porcsYNLecE>=33,paste0(round(porcsYNLecE,1),"%"),"")), size=4) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje relativo por rango de edad",
fill="Rango de Edad",
title="Lectura en soporte ... en los últimos 12 meses por edad")+
facet_wrap(~YNLecE_DI)
ggplot(YNLecE_all, aes(x=factor(YNLecE_YN),y=porcsYNLecE,
fill=factor(YNLecE_Edades,levels=c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años"))))+
geom_bar(stat='identity') +
scale_fill_brewer(palette ="Set3",direction=-1) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YNLecE_YN,y=pos,label=ifelse(porcsYNLecE>=33,paste0(round(porcsYNLecE,1),"%"),"")), size=3.5) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje relativo por rango de edad",
fill="Rango de Edad",
title="Lectura en soporte ... en los últimos 12 meses por edad")+
facet_wrap(~YNLecE_DI)
ggplot(YNLecE_all, aes(x=factor(YNLecE_YN),y=porcsYNLecE,
fill=factor(YNLecE_Edades,levels=rev(c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años")))))+
geom_bar(stat='identity') +
scale_fill_brewer(palette ="Set3",direction=-1) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YNLecE_YN,y=pos,label=ifelse(porcsYNLecE>=33,paste0(round(porcsYNLecE,1),"%"),"")), size=3.5) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje relativo por rango de edad",
fill="Rango de Edad",
title="Lectura en soporte ... en los últimos 12 meses por edad")+
facet_wrap(~YNLecE_DI)
ggplot(YNLecE_all, aes(x=factor(YNLecE_YN),y=porcsYNLecE,
fill=factor(YNLecE_Edades,levels=rev(c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años")))))+
geom_bar(stat='identity') +
scale_fill_brewer(palette ="Set3",direction=-1) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YNLecE_YN,y=pos,label=ifelse(porcsYNLecE>=33,paste0(round(porcsYNLecE,1),"%"),"")), size=3.5) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje relativo por rango de edad",
fill="Rango de Edad",
title="Lectura en soporte ... en los últimos 12 meses por edad")+
facet_wrap(~YNLecE_DI)
tres_plot_YNLecE <- ggplot(YNLecE_all, aes(x=factor(YNLecE_YN),y=porcsYNLecE,
fill=factor(YNLecE_Edades,levels=rev(c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años","De 45 a 54 años","Mayor de 55 años")))))+
geom_bar(stat='identity') +
scale_fill_brewer(palette ="Set3",direction=-1) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(data=YNLecE_all,aes(x=YNLecE_YN,y=pos,label=ifelse(porcsYNLecE>=33,paste0(round(porcsYNLecE,1),"%"),"")), size=3.5) +
labs(x="¿Leyó en soporte ... en los últimos 12 meses?",y="Porcentaje relativo por rango de edad",
fill="Rango de Edad",
title="Lectura en soporte ... en los últimos 12 meses por edad")+
facet_wrap(~YNLecE_DI)
tres_plot_YNLecE
tres_plot_YNLecZ
porcsYNLecE
pobsEdad <- c(sum(base_re$RangosEdad=="Menor de 18 años"),sum(base_re$RangosEdad=="De 18 a 24 años"),
sum(base_re$RangosEdad=="De 25 a 34 años"),sum(base_re$RangosEdad=="De 35 a 44 años"),
sum(base_re$RangosEdad=="De 45 a 54 años"),sum(base_re$RangosEdad=="Mayor de 55 años"))
porcsYNLecE <- numsYNLecE/pobsEdad*100
porcsYNLecE
base_RazNoLecDig <- base_re %>%
filter(!is.na(P1864S1)) %>%
select(RangosEdad,DOMINIO,P260,P4031S1A1,30,34:41,31:33) # Filtra personas que respondieron P1864
razonesD <- c("Otras preferencias","Dinero","Salud","Pereza","No tiene dispositivos",
"Duda qué leer","Acceso a internet","No sabe usar dispositivos","Tiempo",
"Desinterés","Prefiere impreso","Otra")
names(base_RazNoLecDig)[5:16] <- razonesD # Cambia nombres de las razones
agrupaD <- base_RazNoLecDig %>% # Cuenta frecuencia de los rangos de edad en las razones
group_by(RangosEdad) %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1), Dinero = sum(Dinero==1),
Salud = sum(Salud ==1), Pereza = sum(Pereza==1), Falta_dis = sum(`No tiene dispositivos`==1),
Duda = sum(`Duda qué leer`==1), Internet = sum(`Acceso a internet`==1),
Uso = sum(`No sabe usar dispositivos`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Impreso=sum(`Prefiere impreso`==1),Otra=sum(Otra==1)) # colSums()?
razonesD_ <- c(rep("Otras preferencias",6),rep("Dinero",6),rep("Salud",6),rep("Pereza",6),
rep("No tiene dispositivos",6),rep("Duda qué leer",6),rep("Acceso a internet",6),
rep("No sabe usar dispositivos",6),rep("Tiempo",6),rep("Desinterés",6),
rep("Prefiere impreso",6),rep("Otra",6)) # Necesario para el diagrama de barras apiladas posterior
numsD <- c()
for(i in 2:13){
numsD <- c(numsD,pull(agrupaD,i)) # Une datos numéricos de agrupa en un solo vector
}
porcsD <- numsD/pobsEdad
tres_Dig <- data.frame(razonesD_,agrupaD[1],numsD,porcsD) # Dataframe con los datos necesarios para barras apiladas
tres_plot_Dig <- ggplot(tres_Dig, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=numsD, x=reorder(razonesD_,numsD))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Frecuencia",fill="Rango de Edad",
title="Razones Digital") # Barras apiladas
tres_plot_Dig
tres_plot_DigPorcs <- ggplot(tres_Dig, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=numsD, x=reorder(razonesD_,porcsD))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Porcentaje relativo por rango de edad",fill="Rango de Edad",
title="Razones Digital")
tres_plot_DigPorcs
tres_plot_DigPorcs <- ggplot(tres_Dig, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=porcssD, x=reorder(razonesD_,porcsD))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Porcentaje relativo por rango de edad",fill="Rango de Edad",
title="Razones Digital")
tres_plot_DigPorcs
tres_plot_DigPorcs <- ggplot(tres_Dig, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=porcsD, x=reorder(razonesD_,porcsD))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Porcentaje relativo por rango de edad",fill="Rango de Edad",
title="Razones Digital")
tres_plot_DigPorcs
razonesI <- c("Otras preferencias","Tiempo","Desinterés","Pereza","Dinero","Duda qué leer",
"Salud","Acceso a material","Prefiere digital","Otra")
base_RazNoLecImp <- base_re %>%
filter(!is.na(P1865S1)) %>%
select(RangosEdad,DOMINIO,P260,P4031S1A1,42,44:51,43)
razonesI <- c("Otras preferencias","Tiempo","Desinterés","Pereza","Dinero","Duda qué leer",
"Salud","Acceso a material","Prefiere digital","Otra")
names(base_RazNoLecImp)[5:14] <- razonesI # Cambia nombres de las razones
agrupaI <- base_RazNoLecImp %>% # Cuenta frecuencia de los rangos de edad en las razones
group_by(RangosEdad) %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Pereza=sum(Pereza==1),Dinero = sum(Dinero==1),
Duda=sum(`Duda qué leer`==1),Salud=sum(Salud==1),Acceso=sum(`Acceso a material`==1),
Digital=sum(`Prefiere digital`==1),Otra=sum(Otra==1))
razonesI_ <- c(rep("Otras preferencias",6),rep("Tiempo",6),rep("Desinterés",6),rep("Pereza",6),
rep("Dinero",6),rep("Duda qué leer",6),rep("Salud",6),
rep("Acceso a material",6),rep("Prefiere digital",6),rep("Otra",6)) # Necesario para el diagrama de barras apiladas posterior
numsI <- c()
for(i in 2:11){
numsI <- c(numsI,pull(agrupaI,i)) # Une datos numéricos de agrupa en un solo vector
}
View(agrupaI)
View(agrupaD)
agrupaD <- rbind(agrupaD[,6],agrupaD[,1:5])
agrupaD[,6]
agrupaD[6,]
agrupaD <- rbind(agrupaD[6,],agrupaD[1:5,])
razonesD_ <- c(rep("Otras preferencias",6),rep("Dinero",6),rep("Salud",6),rep("Pereza",6),
rep("No tiene dispositivos",6),rep("Duda qué leer",6),rep("Acceso a internet",6),
rep("No sabe usar dispositivos",6),rep("Tiempo",6),rep("Desinterés",6),
rep("Prefiere impreso",6),rep("Otra",6)) # Necesario para el diagrama de barras apiladas posterior
numsD <- c()
for(i in 2:13){
numsD <- c(numsD,pull(agrupaD,i)) # Une datos numéricos de agrupa en un solo vector
}
porcsD <- numsD/pobsEdad*100
tres_Dig <- data.frame(razonesD_,agrupaD[1],numsD,porcsD) # Dataframe con los datos necesarios para barras apiladas
tres_plot_Dig <- ggplot(tres_Dig, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=numsD, x=reorder(razonesD_,numsD))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Frecuencia",fill="Rango de Edad",
title="Razones Digital") # Barras apiladas
tres_plot_Dig
tres_plot_DigPorcs <- ggplot(tres_Dig, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=porcsD, x=reorder(razonesD_,porcsD))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Porcentaje relativo por rango de edad",fill="Rango de Edad",
title="Razones Digital")
tres_plot_DigPorcs
View(tres_Dig)
agrupaD <- base_RazNoLecDig %>% # Cuenta frecuencia de los rangos de edad en las razones
group_by(RangosEdad) %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1), Dinero = sum(Dinero==1),
Salud = sum(Salud ==1), Pereza = sum(Pereza==1), Falta_dis = sum(`No tiene dispositivos`==1),
Duda = sum(`Duda qué leer`==1), Internet = sum(`Acceso a internet`==1),
Uso = sum(`No sabe usar dispositivos`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Impreso=sum(`Prefiere impreso`==1),Otra=sum(Otra==1)) # colSums()?
razonesD_ <- c(rep("Otras preferencias",6),rep("Dinero",6),rep("Salud",6),rep("Pereza",6),
rep("No tiene dispositivos",6),rep("Duda qué leer",6),rep("Acceso a internet",6),
rep("No sabe usar dispositivos",6),rep("Tiempo",6),rep("Desinterés",6),
rep("Prefiere impreso",6),rep("Otra",6)) # Necesario para el diagrama de barras apiladas posterior
numsD <- c()
for(i in 2:13){
numsD <- c(numsD,pull(agrupaD,i)) # Une datos numéricos de agrupa en un solo vector
}
porcsD <- numsD/pobsEdad*100
tres_Dig <- data.frame(razonesD_,agrupaD[1],numsD,porcsD) # Dataframe con los datos necesarios para barras apiladas
tres_plot_Dig <- ggplot(tres_Dig, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=numsD, x=reorder(razonesD_,numsD))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Frecuencia",fill="Rango de Edad",
title="Razones Digital") # Barras apiladas
tres_plot_DigPorcs <- ggplot(tres_Dig, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=porcsD, x=reorder(razonesD_,porcsD))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Porcentaje relativo por rango de edad",fill="Rango de Edad",
title="Razones Digital")
tres_plot_DigPorcs
agrupaD <- base_RazNoLecDig %>% # Cuenta frecuencia de los rangos de edad en las razones
group_by(RangosEdad) %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1), Dinero = sum(Dinero==1),
Salud = sum(Salud ==1), Pereza = sum(Pereza==1), Falta_dis = sum(`No tiene dispositivos`==1),
Duda = sum(`Duda qué leer`==1), Internet = sum(`Acceso a internet`==1),
Uso = sum(`No sabe usar dispositivos`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Impreso=sum(`Prefiere impreso`==1),Otra=sum(Otra==1)) # colSums()?
agrupaD <- rbind(agrupaD[6,],agrupaD[1:5,])
razonesD_ <- c(rep("Otras preferencias",6),rep("Dinero",6),rep("Salud",6),rep("Pereza",6),
rep("No tiene dispositivos",6),rep("Duda qué leer",6),rep("Acceso a internet",6),
rep("No sabe usar dispositivos",6),rep("Tiempo",6),rep("Desinterés",6),
rep("Prefiere impreso",6),rep("Otra",6)) # Necesario para el diagrama de barras apiladas posterior
numsD <- c()
for(i in 2:13){
numsD <- c(numsD,pull(agrupaD,i)) # Une datos numéricos de agrupa en un solo vector
}
porcsD <- numsD/pobsEdad*100
tres_Dig <- data.frame(razonesD_,agrupaD[1],numsD,porcsD) # Dataframe con los datos necesarios para barras apiladas
tres_plot_Dig <- ggplot(tres_Dig, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=numsD, x=reorder(razonesD_,numsD))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Frecuencia",fill="Rango de Edad",
title="Razones Digital") # Barras apiladas
tres_plot_DigPorcs <- ggplot(tres_Dig, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=porcsD, x=reorder(razonesD_,porcsD))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Porcentaje relativo por rango de edad",fill="Rango de Edad",
title="Razones Digital")
tres_plot_DigPorcs
cuat_NivZona <- base_NiñezEdu %>%
group_by(DOMINIO) %>%
summarise(Ninguna=sum(Educación==0),Preescolar=sum(Educación==1),`Básica primaria`=sum(Educación==2),
`Básica secundaria`=sum(Educación==3),`Media académica`=sum(Educación==4),
`Media técnica`=sum(Educación==5),Normalista=sum(Educación==6),`Técnica`=sum(Educación==7),
`Tecnológica`=sum(Educación==8),Universitario=sum(Educación==9),Especialización=sum(Educación==10),
Maestría=sum(Educación==11),Doctorado=sum(Educación==12))
base_NiñezEdu <- base_re %>% # Selecciona variables necesarias, excluye <18 por su educación
filter(RangosEdad!="Menor de 18 años") %>%
select(ID,RangosEdad,DOMINIO,P260,P4031S1A1,11:16)
cuat_noms <- c("Educación","Estrato","Iba a bibliotecas",
"Iba a librerías","Veía leer",
"Le leían","Profs motivaban leer",
"Profs motivaban ir a bibs")
names(base_NiñezEdu)[4:11] <- cuat_noms # Cambia nombres de columnas
cuat_NivZona <- base_NiñezEdu %>%
group_by(DOMINIO) %>%
summarise(Ninguna=sum(Educación==0),Preescolar=sum(Educación==1),`Básica primaria`=sum(Educación==2),
`Básica secundaria`=sum(Educación==3),`Media académica`=sum(Educación==4),
`Media técnica`=sum(Educación==5),Normalista=sum(Educación==6),`Técnica`=sum(Educación==7),
`Tecnológica`=sum(Educación==8),Universitario=sum(Educación==9),Especialización=sum(Educación==10),
Maestría=sum(Educación==11),Doctorado=sum(Educación==12))
View(cuat_NivZona)
base_RazNoLecImp <- base_re %>%
filter(!is.na(P1865S1)) %>%
select(RangosEdad,DOMINIO,P260,P4031S1A1,42,44:51,43)
razonesI <- c("Otras preferencias","Tiempo","Desinterés","Pereza","Dinero","Duda qué leer",
"Salud","Acceso a material","Prefiere digital","Otra")
names(base_RazNoLecImp)[5:14] <- razonesI # Cambia nombres de las razones
agrupaI <- base_RazNoLecImp %>% # Cuenta frecuencia de los rangos de edad en las razones
group_by(RangosEdad) %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Pereza=sum(Pereza==1),Dinero = sum(Dinero==1),
Duda=sum(`Duda qué leer`==1),Salud=sum(Salud==1),Acceso=sum(`Acceso a material`==1),
Digital=sum(`Prefiere digital`==1),Otra=sum(Otra==1))
View(agrupaI)
agrupaI <- rbind(agrupaI[6,],agrupaI[1:5,])
razonesI_ <- c(rep("Otras preferencias",6),rep("Tiempo",6),rep("Desinterés",6),rep("Pereza",6),
rep("Dinero",6),rep("Duda qué leer",6),rep("Salud",6),
rep("Acceso a material",6),rep("Prefiere digital",6),rep("Otra",6)) # Necesario para el diagrama de barras apiladas posterior
numsI <- c()
for(i in 2:11){
numsI <- c(numsI,pull(agrupaI,i)) # Une datos numéricos de agrupa en un solo vector
}
porcsI <- numsI/pobsEdad*100
tres_Imp <- data.frame(razonesI_,agrupaI[1],numsI) # Dataframe con los datos necesarios para barras apiladas
tres_Imp <- data.frame(razonesI_,agrupaI[1],numsI,porcsI) # Dataframe con los datos necesarios para barras apiladas
tres_plot_Imp <- ggplot(tres_Imp, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=numsI, x=reorder(razonesI_,numsI))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee impreso",y="Frecuencia",fill="Rango de Edad",
title="Razones Impreso") # Barras apiladas
tres_plot_ImpPorcs <- ggplot(tres_Imp, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=porcsI, x=reorder(razonesI_,porcsI))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee impreso",y="Porcentaje relativo por rango de edad",fill="Rango de Edad",
title="Razones Impreso") # Barras apiladas
tres_plot_ImpPorcs
base_RazNoLecImp <- base_re %>%
filter(!is.na(P1865S1)) %>%
select(RangosEdad,DOMINIO,P260,P4031S1A1,42,44:51,43)
razonesI <- c("Otras preferencias","Tiempo","Desinterés","Pereza","Dinero","Duda qué leer",
"Salud","Acceso a material","Prefiere digital","Otra")
names(base_RazNoLecImp)[5:14] <- razonesI # Cambia nombres de las razones
agrupaI <- base_RazNoLecImp %>% # Cuenta frecuencia de los rangos de edad en las razones
group_by(RangosEdad) %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Pereza=sum(Pereza==1),Dinero = sum(Dinero==1),
Duda=sum(`Duda qué leer`==1),Salud=sum(Salud==1),Acceso=sum(`Acceso a material`==1),
Digital=sum(`Prefiere digital`==1),Otra=sum(Otra==1))
agrupaI <- rbind(agrupaI[6,],agrupaI[1:5,])
razonesI_ <- c(rep("Otras preferencias",6),rep("Tiempo",6),rep("Desinterés",6),rep("Pereza",6),
rep("Dinero",6),rep("Duda qué leer",6),rep("Salud",6),
rep("Acceso a material",6),rep("Prefiere digital",6),rep("Otra",6)) # Necesario para el diagrama de barras apiladas posterior
numsI <- c()
for(i in 2:11){
numsI <- c(numsI,pull(agrupaI,i)) # Une datos numéricos de agrupa en un solo vector
}
porcsI <- numsI/pobsEdad*100
tres_Imp <- data.frame(razonesI_,agrupaI[1],numsI,porcsI) # Dataframe con los datos necesarios para barras apiladas
tres_plot_Imp <- ggplot(tres_Imp, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=numsI, x=reorder(razonesI_,numsI))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee impreso",y="Frecuencia",fill="Rango de Edad",
title="Razones Impreso") # Barras apiladas
tres_plot_ImpPorcs <- ggplot(tres_Imp, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=porcsI, x=reorder(razonesI_,porcsI))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee impreso",y="Porcentaje relativo por rango de edad",fill="Rango de Edad",
title="Razones Impreso") # Barras apiladas
tres_plot_ImpPorcs
agrupaI <- base_RazNoLecImp %>% # Cuenta frecuencia de los rangos de edad en las razones
group_by(RangosEdad) %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Pereza=sum(Pereza==1),Dinero = sum(Dinero==1),
Duda=sum(`Duda qué leer`==1),Salud=sum(Salud==1),Acceso=sum(`Acceso a material`==1),
Digital=sum(`Prefiere digital`==1),Otra=sum(Otra==1))
agrupaI <- rbind(agrupaI[6,],agrupaI[1:5,])
agrupaI <- base_RazNoLecImp %>% # Cuenta frecuencia de los rangos de edad en las razones
group_by(RangosEdad) %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Pereza=sum(Pereza==1),Dinero = sum(Dinero==1),
Duda=sum(`Duda qué leer`==1),Salud=sum(Salud==1),Acceso=sum(`Acceso a material`==1),
Digital=sum(`Prefiere digital`==1),Otra=sum(Otra==1))
agrupaI <- rbind(agrupaI[6,],agrupaI[1:5,])
razonesI_ <- c(rep("Otras preferencias",6),rep("Tiempo",6),rep("Desinterés",6),rep("Pereza",6),
rep("Dinero",6),rep("Duda qué leer",6),rep("Salud",6),
rep("Acceso a material",6),rep("Prefiere digital",6),rep("Otra",6)) # Necesario para el diagrama de barras apiladas posterior
numsI <- c()
for(i in 2:11){
numsI <- c(numsI,pull(agrupaI,i)) # Une datos numéricos de agrupa en un solo vector
}
numsI
porcsI <- numsI/pobsEdad*100
porcsI
View(base_YNLecE)
YNLecE_Edades <- rep(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años","De 45 a 54 años",
"Mayor de 55 años"),4)
YNLecE_Edades
base_YNLecE[1]
YNLecE_Edades
YNLecE_Edades <- rep(base_YNLecE[1],4)
YNLecE_Edades
agrupaI[1]
tres_Imp <- data.frame(razonesI_,agrupaI[1],numsI,porcsI) # Dataframe con los datos necesarios para barras apiladas
tres_Imp
YNLecE_Edades
YNLecE_all
YNLecE_all <- data.frame(YNLecE_Edades,YNLecE_DI,YNLecE_YN,numsYNLecE,porcsYNLecE)
YNLecE_all
YNLecE_Edades <- rep(c("Menor de 18 años","De 18 a 24 años","De 25 a 34 años","De 35 a 44 años","De 45 a 54 años",
"Mayor de 55 años"),4)
YNLecE_all <- data.frame(YNLecE_Edades,YNLecE_DI,YNLecE_YN,numsYNLecE,porcsYNLecE)
YNLecE_all
tres_Imp <- data.frame(razonesI_,agrupaI[1],numsI,porcsI) # Dataframe con los datos necesarios para barras apiladas
base_RazNoLecImp <- base_re %>%
filter(!is.na(P1865S1)) %>%
select(RangosEdad,DOMINIO,P260,P4031S1A1,42,44:51,43)
razonesI <- c("Otras preferencias","Tiempo","Desinterés","Pereza","Dinero","Duda qué leer",
"Salud","Acceso a material","Prefiere digital","Otra")
names(base_RazNoLecImp)[5:14] <- razonesI # Cambia nombres de las razones
agrupaI <- base_RazNoLecImp %>% # Cuenta frecuencia de los rangos de edad en las razones
group_by(RangosEdad) %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Pereza=sum(Pereza==1),Dinero = sum(Dinero==1),
Duda=sum(`Duda qué leer`==1),Salud=sum(Salud==1),Acceso=sum(`Acceso a material`==1),
Digital=sum(`Prefiere digital`==1),Otra=sum(Otra==1))
agrupaI <- rbind(agrupaI[6,],agrupaI[1:5,])
razonesI_ <- c(rep("Otras preferencias",6),rep("Tiempo",6),rep("Desinterés",6),rep("Pereza",6),
rep("Dinero",6),rep("Duda qué leer",6),rep("Salud",6),
rep("Acceso a material",6),rep("Prefiere digital",6),rep("Otra",6)) # Necesario para el diagrama de barras apiladas posterior
numsI <- c()
for(i in 2:11){
numsI <- c(numsI,pull(agrupaI,i)) # Une datos numéricos de agrupa en un solo vector
}
porcsI <- numsI/pobsEdad*100
tres_Imp <- data.frame(razonesI_,agrupaI[1],numsI,porcsI) # Dataframe con los datos necesarios para barras apiladas
tres_plot_Imp <- ggplot(tres_Imp, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=numsI, x=reorder(razonesI_,numsI))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee impreso",y="Frecuencia",fill="Rango de Edad",
title="Razones Impreso") # Barras apiladas
tres_plot_ImpPorcs <- ggplot(tres_Imp, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=porcsI, x=reorder(razonesI_,porcsI))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee impreso",y="Porcentaje relativo por rango de edad",fill="Rango de Edad",
title="Razones Impreso") # Barras apiladas
tres_plot_ImpPorcs
