levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsDZ_frac, x=reorder(razonesDZ,numsDZ_frac))) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black") +
geom_text(data=tres_DigZ,aes(x=razonesDZ,y=pos,label =ifelse(numsDZ_frac>=6,
paste0(numsDZ_frac,"%"),"")), family="serif",size = 3.5) +
coord_flip()+
scale_fill_brewer(palette ="Pastel1") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Porcentaje del total de personas de esa zona",fill="Zona") # Barras apiladas
tres_plot_DigZfrac
tres_plot_DigZfrac <- ggplot(tres_DigZ, aes(fill=factor(DOMINIO,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsDZ_frac, x=reorder(razonesDZ,numsDZ_frac))) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black") +
geom_text(data=tres_DigZ,aes(x=razonesDZ,y=pos,label =ifelse(numsDZ_frac>=6,
paste0(numsDZ_frac,"%"),"")), family="serif",size = 5) +
coord_flip()+
scale_fill_brewer(palette ="Pastel1") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Porcentaje del total de personas de esa zona",fill="Zona") # Barras apiladas
tres_plot_DigZfrac <- ggplot(tres_DigZ, aes(fill=factor(DOMINIO,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsDZ_frac, x=reorder(razonesDZ,numsDZ_frac))) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black") +
geom_text(data=tres_DigZ,aes(x=razonesDZ,y=pos,label =ifelse(numsDZ_frac>=6,
paste0(numsDZ_frac,"%"),"")), family="serif",size = 4) +
coord_flip()+
scale_fill_brewer(palette ="Pastel1") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee digital",y="Porcentaje del total de personas de esa zona",fill="Zona") # Barras apiladas
tres_plot_DigZfrac
base_RazNoLecImp <- base_re %>%
filter(!is.na(P1865S1)) %>%
select(RangosEdad,DOMINIO,P260,P4031S1A1,42,44:51,43)
razonesI <- c("Otras preferencias","Tiempo","Desinterés","Pereza","Dinero","Duda qué leer",
"Salud","Acceso a material","Prefiere digital","Otra")
names(base_RazNoLecImp)[5:14] <- razonesI # Cambia nombres de las razones
agrupaI <- base_RazNoLecImp %>% # Cuenta frecuencia de los rangos de edad en las razones
group_by(RangosEdad) %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Pereza=sum(Pereza==1),Dinero = sum(Dinero==1),
Duda=sum(`Duda qué leer`==1),Salud=sum(Salud==1),Acceso=sum(`Acceso a material`==1),
Digital=sum(`Prefiere digital`==1),Otra=sum(Otra==1))
agrupaI <- rbind(agrupaI[6,],agrupaI[1:5,])
razonesI_ <- c(rep("Otras preferencias",6),rep("Tiempo",6),rep("Desinterés",6),rep("Pereza",6),
rep("Dinero",6),rep("Duda qué leer",6),rep("Salud",6),
rep("Acceso a material",6),rep("Prefiere digital",6),rep("Otra",6)) # Necesario para el diagrama de barras apiladas posterior
numsI <- c()
for(i in 2:11){
numsI <- c(numsI,pull(agrupaI,i)) # Une datos numéricos de agrupa en un solo vector
}
pobsEdadNI <- c(sum(base_re$RangosEdad=="Menor de 18 años"&base_re$P1865S1!=1010),sum(base_re$RangosEdad=="De 18 a 24 años"&base_re$P1865S1!=1010),
sum(base_re$RangosEdad=="De 25 a 34 años"&base_re$P1865S1!=1010),sum(base_re$RangosEdad=="De 35 a 44 años"&base_re$P1865S1!=1010),
sum(base_re$RangosEdad=="De 45 a 54 años"&base_re$P1865S1!=1010),sum(base_re$RangosEdad=="Mayor de 55 años"&base_re$P1865S1!=1010))
porcsI <- numsI/pobsEdadNI*100
tres_Imp <- data.frame(razonesI_,agrupaI[1],numsI,porcsI) # Dataframe con los datos necesarios para barras apiladas
tres_plot_Imp <- ggplot(tres_Imp, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=numsI, x=reorder(razonesI_,numsI))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee impreso",y="Frecuencia",fill="Rango de Edad",
title="Razones Impreso") # Barras apiladas
tres_plot_ImpPorcs <- ggplot(tres_Imp, aes(fill=factor(RangosEdad,
levels = c("Menor de 18 años","De 18 a 24 años",
"De 25 a 34 años","De 35 a 44 años",
"De 45 a 54 años","Mayor de 55 años")),
y=porcsI, x=reorder(razonesI_,porcsI))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.25) +
coord_flip()+
scale_fill_brewer(palette ="Set3") +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(porcsI>20,paste0(round(porcsI,1),"%"),""))+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee impreso",y="Porcentaje relativo por rango de edad",fill="Rango de Edad") # Barras apiladas
tres_plot_ImpPorcs
agrupaIZ <- base_RazNoLecImp %>% # Cuenta frecuencia de las zonas en las razones
group_by(DOMINIO) %>%
summarise(OtrasPrefs = sum(`Otras preferencias`==1),Tiempo = sum(Tiempo==1),
Desinteres=sum(Desinterés==1),Pereza=sum(Pereza==1),Dinero = sum(Dinero==1),
Duda=sum(`Duda qué leer`==1),Salud=sum(Salud==1),Acceso=sum(`Acceso a material`==1),
Digital=sum(`Prefiere digital`==1),Otra=sum(Otra==1))
razonesIZ <- c(rep("Otras preferencias",2),rep("Tiempo",2),rep("Desinterés",2),rep("Pereza",2),
rep("Dinero",2),rep("Duda qué leer",2),rep("Salud",2),
rep("Acceso a material",2),rep("Prefiere digital",2),rep("Otra",2)) # Necesario para el diagrama de barras apiladas posterior
numsIZ <- c()
for(i in 2:11){
numsIZ <- c(numsIZ,pull(agrupaIZ,i)) # Une datos numéricos de agrupa en un solo vector
}
numsIZ_frac <- round(numsIZ/c(sum(base_re$DOMINIO==1&base_re$P1865S1!=1010),sum(base_re$DOMINIO==2&base_re$P1865S1!=1010))*100,1) # Calcula fracción que representa del total de esa zona
tres_ImpZ <- data.frame(razonesIZ,agrupaIZ[1],numsIZ,numsIZ_frac) # Dataframe con los datos necesarios para barras apiladas
library(plyr)
tres_ImpZ <- ddply(tres_ImpZ, .(razonesIZ),
transform, pos = cumsum(numsIZ_frac) - (0.5 * numsIZ_frac))
detach("package:plyr",unload = T)
tres_plot_ImpZfrac <- ggplot(tres_ImpZ, aes(fill=factor(DOMINIO,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsIZ_frac, x=reorder(razonesIZ,numsIZ_frac))) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black") +
geom_text(data=tres_ImpZ,aes(x=razonesIZ,y=pos,label =ifelse(numsIZ_frac>=6,
paste0(numsIZ_frac,"%"),"")), size=4) +
coord_flip()+
scale_fill_brewer(palette ="Pastel1") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee impreso",y="Porcentaje del total de personas de esa zona",fill="Zona") # Barras apiladas
tres_plot_ImpZfrac
tres_plot_ImpZfrac <- ggplot(tres_ImpZ, aes(fill=factor(DOMINIO,
levels = c("1","2"),labels = c("Urbana","Rural")),
y=numsIZ_frac, x=reorder(razonesIZ,numsIZ_frac))) +
geom_bar(position=position_stack(reverse=T), stat="identity", colour="black") +
geom_text(data=tres_ImpZ,aes(x=razonesIZ,y=pos,label =ifelse(numsIZ_frac>=6,
paste0(numsIZ_frac,"%"),"")), family="serif",size = 4) +
coord_flip()+
scale_fill_brewer(palette ="Pastel1") +
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Razón por la que no lee impreso",y="Porcentaje del total de personas de esa zona",fill="Zona") # Barras apiladas
tres_plot_ImpZfrac
f_Zona <- base_re %>%
freq(DOMINIO, report.nas = FALSE)
f_Zona
pgeom(1,0.1)
dgeom(1,0.1)
cinco_plot_Ps <- ggplot(cinco_Ps_all, aes(x=factor(ests,levels=1:6),y=porcsTiLecEstPs,
fill=factor(horas,levels = c("No sabe / No informa",
"Más de 10 horas","8 a 10 horas","6 a 7 horas","5 horas",
"4 horas","3 horas","2 horas","1 hora","Menos de una hora")))) +
geom_bar(stat='identity') +
scale_fill_brewer(palette ="RdYlGn") +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
labs(x="Estrato",y="Porcentaje relativo por estrato",
fill=stringr::str_wrap("Tiempo semanal de lectura de ...",21))+
#title="Tiempo de lectura de ... en los últimos 12 meses por estrato")+
facet_wrap(~stringr::str_wrap(pregs,20))
library(wesanderson)
library(hrbrthemes)
library(RColorBrewer)
library(openxlsx)
library(dplyr)
library(summarytools)
library(ggplot2)
cinco_plot_Ps <- ggplot(cinco_Ps_all, aes(x=factor(ests,levels=1:6),y=porcsTiLecEstPs,
fill=factor(horas,levels = c("No sabe / No informa",
"Más de 10 horas","8 a 10 horas","6 a 7 horas","5 horas",
"4 horas","3 horas","2 horas","1 hora","Menos de una hora")))) +
geom_bar(stat='identity') +
scale_fill_brewer(palette ="RdYlGn") +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
labs(x="Estrato",y="Porcentaje relativo por estrato",
fill=stringr::str_wrap("Tiempo semanal de lectura de ...",21))+
#title="Tiempo de lectura de ... en los últimos 12 meses por estrato")+
facet_wrap(~stringr::str_wrap(pregs,20))
cinco_plot_Ps
cinco_plot_Ps <- ggplot(cinco_Ps_all, aes(x=factor(ests,levels=1:6),y=porcsTiLecEstPs,
fill=factor(horas,levels = c("No sabe / No informa",
"Más de 10 horas","8 a 10 horas","6 a 7 horas","5 horas",
"4 horas","3 horas","2 horas","1 hora","Menos de una hora")))) +
geom_bar(stat='identity') +
scale_fill_brewer(palette ="RdYlGn") +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(porcsTiLecEstPs>11.5,paste0(round(porcsTiLecEstPs,1),"%"),""))+
labs(x="Estrato",y="Porcentaje relativo por estrato",
fill=stringr::str_wrap("Tiempo semanal de lectura de ...",21))+
#title="Tiempo de lectura de ... en los últimos 12 meses por estrato")+
facet_wrap(~stringr::str_wrap(pregs,20))
cinco_plot_Ps
cinco_plot_Ps <- ggplot(cinco_Ps_all, aes(x=factor(ests,levels=1:6),y=porcsTiLecEstPs,
fill=factor(horas,levels = c("No sabe / No informa",
"Más de 10 horas","8 a 10 horas","6 a 7 horas","5 horas",
"4 horas","3 horas","2 horas","1 hora","Menos de una hora")))) +
geom_bar(stat='identity') +
scale_fill_brewer(palette ="RdYlGn") +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.1) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(porcsTiLecEstPs>0.05,paste0(round(porcsTiLecEstPs,1),"%"),""))+
labs(x="Estrato",y="Porcentaje relativo por estrato",
fill=stringr::str_wrap("Tiempo semanal de lectura de ...",21))+
#title="Tiempo de lectura de ... en los últimos 12 meses por estrato")+
facet_wrap(~stringr::str_wrap(pregs,20))
cinco_plot_Ps
f_Zona
f_Sexo
f_Sexo <- base_re %>%
freq(P6020, report.nas = FALSE)
f_Sexo
f_LecDig <- base_re %>%
freq(P1855, report.nas = FALSE)
f_LecDig
f_Edad
f_Edad <- base_re %>%
freq(RangosEdad, report.nas = FALSE)
f_Edad
view(f_Edad)
f_Zona
f_Edad <- base_re %>%
freq('Rangos de Edad' = RangosEdad, report.nas = FALSE)
f_Edad
view(f_Edad)
f_Edad <- base_re %>%
freq(RangosEdad, report.nas = FALSE)
view(f_Edad)
base_re <- base %>%
mutate(RangosEdad = case_when(P5785 >=0 & P5785 <18 ~ "1Menor de 18 años",
P5785 >=18 & P5785 <=24 ~ "De 18 a 24 años",
P5785 >=25 & P5785 <=34 ~ "De 25 a 34 años",
P5785 >=35 & P5785 <=44 ~ "De 35 a 44 años",
P5785 >=45 & P5785 <=54 ~ "De 45 a 54 años",
P5785 >=55 ~ "Mayor de 55 años"))
base_re[is.na(base_re)] <- 1010
f_Edad <- base_re %>%
freq(RangosEdad, report.nas = FALSE)
view(f_Edad)
base_re <- base %>%
mutate(RangosEdad = case_when(P5785 >=0 & P5785 <18 ~ "Menor de 18 años",
P5785 >=18 & P5785 <=24 ~ "De 18 a 24 años",
P5785 >=25 & P5785 <=34 ~ "De 25 a 34 años",
P5785 >=35 & P5785 <=44 ~ "De 35 a 44 años",
P5785 >=45 & P5785 <=54 ~ "De 45 a 54 años",
P5785 >=55 ~ "Mayor de 55 años"))
base_re[is.na(base_re)] <- 1010
f_Est <- base_re %>%
freq(P4031S1A1, report.nas = FALSE)
f_Est
f_Est <- base_re %>%
filter(P4031S1A1!=0&P4031S1A1!=1010) %>%
freq(P4031S1A1, report.nas = FALSE)
f_Est
f_Est <- base_re %>%
filter(P4031S1A1!=0&P4031S1A1!=1010&P4031S1A1!=0) %>%
freq(P4031S1A1, report.nas = FALSE)
f_Est <- base_re %>%
filter(P4031S1A1!=0&P4031S1A1!=1010&P4031S1A1!=9) %>%
freq(P4031S1A1, report.nas = FALSE)
f_Est
# ---- FRECUENCIA DE VARIABLES DE INTERÉS ----
96442/50000000*100
# ---- FRECUENCIA DE VARIABLES DE INTERÉS ----
96442/48000000*100
# ---- FRECUENCIA DE VARIABLES DE INTERÉS ----
96442/48285494*100
f_Sexo
view(f_Est)
view(f_Edad)
f_Educ <- base_re %>%
freq(P260, report.nas = FALSE)
f_Educ
f_Educ <- base_re %>%
filter(RangosEdad!="Menor de 18 años") %>%
freq(P260, report.nas = FALSE)
f_Educ
f_Educ <- base_re %>%
filter(RangosEdad=="Menor de 18 años") %>%
freq(P260, report.nas = FALSE)
f_Educ
f_EstCiv <- base_re %>%
freq(P6070, report.nas = FALSE)
f_EstCiv
f_Educ <- base_re %>%
filter(RangosEdad!="Menor de 18 años") %>%
freq(P260, report.nas = FALSE)
f_Educ
view(f_Educ)
f_Sexo <- base_re %>%
freq(P6020, report.nas = FALSE)
f_Sexo
f_Zona <- base_re %>%
filter(P4031S1A1==1|P4031S1A1==2)
f_Zona
f_Zona <- base_re %>%
filter(P4031S1A1==1|P4031S1A1==2) %>%
freq(DOMINIO, report.nas = FALSE)
f_Zona
f_Zona <- base_re %>%
freq(DOMINIO, report.nas = FALSE)
f_Zona
# ---- FRECUENCIA DE VARIABLES DE INTERÉS ----
100-96.6
# ---- FRECUENCIA DE VARIABLES DE INTERÉS ----
100-96.96
# ---- FRECUENCIA DE VARIABLES DE INTERÉS ----
100-91.58
# ---- FRECUENCIA DE VARIABLES DE INTERÉS ----
35+33+20
# ---- FRECUENCIA DE VARIABLES DE INTERÉS ----
35.1+33.66+20.45
f_Sexo
# ---- FRECUENCIA DE VARIABLES DE INTERÉS ----
13.54+24.61+20.27+16.9
View(base_NiñezEdu)
cuat_NivEdad <- base_NiñezEdu %>%
group_by(RangosEdad) %>%
summarise(Ninguna=sum(Educación==0),Preescolar=sum(Educación==1),`Básica primaria`=sum(Educación==2),
`Básica secundaria`=sum(Educación==3),`Media académica`=sum(Educación==4),
`Media técnica`=sum(Educación==5),Normalista=sum(Educación==6),`Técnica`=sum(Educación==7),
`Tecnológica`=sum(Educación==8),Universitario=sum(Educación==9),Especialización=sum(Educación==10),
Maestría=sum(Educación==11),Doctorado=sum(Educación==12))
View(cuat_NivEdad)
pobsNiv
cuat_NivEdad <- base_NiñezEdu %>%
group_by(RangosEdad) %>%
summarise(Ninguna=sum(Educación==0),Preescolar=sum(Educación==1),`Básica primaria`=sum(Educación==2),
`Básica secundaria`=sum(Educación==3),`Media académica`=sum(Educación==4),
`Media técnica`=sum(Educación==5),Normalista=sum(Educación==6),`Técnica`=sum(Educación==7),
`Tecnológica`=sum(Educación==8),Universitario=sum(Educación==9),Especialización=sum(Educación==10),
Maestría=sum(Educación==11),Doctorado=sum(Educación==12))
numsNivE <- c()
for(i in 2:14){
numsNivE <- c(numsNivE,pull(cuat_NivEdad,i)) # Une datos numéricos de nivs de educ en un solo vector
}
numsNivE
pobsEdad <- c(sum(base_re$RangosEdad=="De 18 a 24 años"),sum(base_re$RangosEdad=="De 25 a 34 años"),
sum(base_re$RangosEdad=="De 35 a 44 años"),sum(base_re$RangosEdad=="De 45 a 54 años"),
sum(base_re$RangosEdad=="Mayor de 55 años"))
numsNivZ_porc <- round(numsNivZ/pobsEdad*100,1)
numsNivE_porc <- round(numsNivE/pobsEdad*100,1)
for(i in 0:12){
t <- numsNivE_porc[2*i+2]
numsNivE_porc[2*i+2] <- numsNivE_porc[2*i+1]
numsNivE_porc[2*i+1] <- t
}
Edades <- rep(c("De 18 a 24 años","De 25 a 34 años","De 35 a 44 años","De 45 a 54 años",
"Mayor de 55 años"),13)
numsNivE_porc
NivsE <- c(rep("Ninguna",5),rep("Preescolar",5),rep("Básica primaria",5),
rep("Básica secundaria",5),rep("Media académica",5),rep("Media técnica",5),
rep("Normalista",5),rep("Técnica",5),rep("Tecnológica",5),rep("Universitario",5),
rep("Especialización",5),rep("Maestría",5),rep("Doctorado",5))
NivsE
cuat_NE_all <- data.frame(Edades,NivsE,numsNivE_porc)
library(plyr)
cuat_NE_all <- ddply(cuat_NE_all, .(NivsE),
transform, pos = cumsum(numsNivE_porc) - (0.5 * numsNivE_porc))
detach("package:plyr",unload = T)
cuat_NE_plot <- ggplot(cuat_NE_all, aes(fill=factor(Edades),
y=numsNivE_porc, x=factor(NivsE,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(data=cuat_NE_all,aes(x=NivsE,y=pos,label =ifelse(numsNivE_porc>3.5,
paste0(numsNivE_porc,"%"),"")), family="serif",size = 3.5) +
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NE_plot
cuat_NivEdad <- base_NiñezEdu %>%
group_by(RangosEdad) %>%
summarise(Ninguna=sum(Educación==0),Preescolar=sum(Educación==1),`Básica primaria`=sum(Educación==2),
`Básica secundaria`=sum(Educación==3),`Media académica`=sum(Educación==4),
`Media técnica`=sum(Educación==5),Normalista=sum(Educación==6),`Técnica`=sum(Educación==7),
`Tecnológica`=sum(Educación==8),Universitario=sum(Educación==9),Especialización=sum(Educación==10),
Maestría=sum(Educación==11),Doctorado=sum(Educación==12))
numsNivE <- c()
for(i in 2:14){
numsNivE <- c(numsNivE,pull(cuat_NivEdad,i)) # Une datos numéricos de nivs de educ en un solo vector
}
pobsEdad <- c(sum(base_re$RangosEdad=="De 18 a 24 años"),sum(base_re$RangosEdad=="De 25 a 34 años"),
sum(base_re$RangosEdad=="De 35 a 44 años"),sum(base_re$RangosEdad=="De 45 a 54 años"),
sum(base_re$RangosEdad=="Mayor de 55 años"))
numsNivE_porc <- round(numsNivE/pobsEdad*100,1)
for(i in 0:12){
t <- numsNivE_porc[2*i+2]
numsNivE_porc[2*i+2] <- numsNivE_porc[2*i+1]
numsNivE_porc[2*i+1] <- t
}
Edades <- rep(c("De 18 a 24 años","De 25 a 34 años","De 35 a 44 años","De 45 a 54 años",
"Mayor de 55 años"),13)
NivsE <- c(rep("Ninguna",5),rep("Preescolar",5),rep("Básica primaria",5),
rep("Básica secundaria",5),rep("Media académica",5),rep("Media técnica",5),
rep("Normalista",5),rep("Técnica",5),rep("Tecnológica",5),rep("Universitario",5),
rep("Especialización",5),rep("Maestría",5),rep("Doctorado",5))
cuat_NE_all <- data.frame(Edades,NivsE,numsNivE_porc)
library(plyr)
cuat_NE_all <- ddply(cuat_NE_all, .(NivsE),
transform, pos = cumsum(numsNivE_porc) - (0.5 * numsNivE_porc))
detach("package:plyr",unload = T)
cuat_NE_plot <- ggplot(cuat_NE_all, aes(fill=factor(Edades),
y=numsNivE_porc, x=factor(NivsE,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(data=cuat_NE_all,aes(x=NivsE,y=pos,label =ifelse(numsNivE_porc>3.5,
paste0(numsNivE_porc,"%"),"")), family="serif",size = 3.5) +
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NE_plot
cuat_NE_plot <- ggplot(cuat_NE_all, aes(fill=factor(Edades),
y=numsNivE_porc, x=factor(NivsE,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivE_porc>50,paste0(round(numsNivE_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NE_plot
cuat_NE_plot <- ggplot(cuat_NE_all, aes(fill=factor(Edades),
y=numsNivE_porc, x=factor(NivsE,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivE_porc>10,paste0(round(numsNivE_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NE_plot
cuat_NE_plot <- ggplot(cuat_NE_all, aes(fill=Edades,
y=numsNivE_porc, x=factor(NivsE,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivE_porc>10,paste0(round(numsNivE_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NE_plot
cuat_NE_plot <- ggplot(cuat_NE_all, aes(fill=Edades,
y=numsNivE_porc, x=factor(NivsE,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivE_porc>1,paste0(round(numsNivE_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NE_plot
View(cuat_NE_all)
cuat_NE_plot
cuat_NivEdad <- base_NiñezEdu %>%
group_by(RangosEdad) %>%
summarise(Ninguna=sum(Educación==0),Preescolar=sum(Educación==1),`Básica primaria`=sum(Educación==2),
`Básica secundaria`=sum(Educación==3),`Media académica`=sum(Educación==4),
`Media técnica`=sum(Educación==5),Normalista=sum(Educación==6),`Técnica`=sum(Educación==7),
`Tecnológica`=sum(Educación==8),Universitario=sum(Educación==9),Especialización=sum(Educación==10),
Maestría=sum(Educación==11),Doctorado=sum(Educación==12))
numsNivE <- c()
for(i in 2:14){
numsNivE <- c(numsNivE,pull(cuat_NivEdad,i)) # Une datos numéricos de nivs de educ en un solo vector
}
pobsEdad <- c(sum(base_re$RangosEdad=="De 18 a 24 años"),sum(base_re$RangosEdad=="De 25 a 34 años"),
sum(base_re$RangosEdad=="De 35 a 44 años"),sum(base_re$RangosEdad=="De 45 a 54 años"),
sum(base_re$RangosEdad=="Mayor de 55 años"))
numsNivE_porc <- round(numsNivE/pobsEdad*100,1)
Edades <- rep(c("De 18 a 24 años","De 25 a 34 años","De 35 a 44 años","De 45 a 54 años",
"Mayor de 55 años"),13)
NivsE <- c(rep("Ninguna",5),rep("Preescolar",5),rep("Básica primaria",5),
rep("Básica secundaria",5),rep("Media académica",5),rep("Media técnica",5),
rep("Normalista",5),rep("Técnica",5),rep("Tecnológica",5),rep("Universitario",5),
rep("Especialización",5),rep("Maestría",5),rep("Doctorado",5))
cuat_NE_all <- data.frame(Edades,NivsE,numsNivE_porc)
cuat_NE_plot <- ggplot(cuat_NE_all, aes(fill=Edades,
y=numsNivE_porc, x=factor(NivsE,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivE_porc>1,paste0(round(numsNivE_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NE_plot
cuat_NE_plot <- ggplot(cuat_NE_all, aes(fill=Edades,
y=numsNivE_porc, x=factor(NivsE,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivE_porc>10,paste0(round(numsNivE_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
#scale_fill_manual(values=wes_palette("Royal2"))
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NE_plot
cuat_NE_plot <- ggplot(cuat_NE_all, aes(fill=Edades,
y=numsNivE_porc, x=factor(NivsE,
levels = c("Ninguna","Preescolar","Básica primaria","Básica secundaria",
"Media académica","Media técnica","Normalista","Técnica","Tecnológica",
"Universitario","Especialización","Maestría","Doctorado")))) +
geom_bar(position=position_stack(reverse=F), stat="identity", colour="black",size=.07) +
geom_text(family="serif",size = 3.5, position = position_stack(vjust = 0.5),label=ifelse(numsNivE_porc>10,paste0(round(numsNivE_porc,1),"%"),""))+
scale_fill_brewer(palette ="Pastel1") +
coord_flip()+
labs(x="Máximo nivel educativo alcanzado",y="Porcentaje del total de esa zona",
fill=stringr::str_wrap("Zona",12))
cuat_NE_plot
view(f_Edad)
tres_plot_YNLecZ
view(f_Edu)
view(f_Educ)
view(f_Est)
